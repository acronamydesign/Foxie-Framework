var ff = require('./ff-bridge-assign.js'),
		$ = require('jquery-browserify'),
		anim = require('gsap'),
		utils = require("./utils.js");

$(window).load(function(){

var componentH = $(ff.listDefault).outerHeight();
$(ff.listDefault).data('height', componentH);
var saved = {
	height:$(ff.listDefault).data().height,
}

var component = {
		btn:$(this),
		menu:$(this).children(ff.listDefault)
}

//set to hide first
$(ff.dropmenuDefault).children( ff.listDefault).css({height:0,display:"block"});

//CLICK FUNCTION

var clicked = false;
$(ff.dropmenuDefault).click(function (e) {

	var component = {
		btn:$(this),
		menu:$(this).children(ff.listDefault),
		icon:$(this).find("[data-glyph]")
	}

	function stepOne(){
		utils.switchClass(component.btn, [ff.dropmenuDefault, ff.dropmenuActive])
		anim.to(component.menu, .3, {
			height: "0"
		});
		utils.switchAttr(component.icon,"glyph",{
			from:"caret-top",
			to:"caret-bottom"
		})
	}

	function stepTwo(){
		utils.switchClass(component.btn, [ff.dropmenuDefault, ff.dropmenuActive])
		anim.to(component.menu, .2, {
			height: saved.height
		});
		utils.switchAttr(component.icon,"glyph",{
			to:"caret-top",
			from:"caret-bottom"
		})
	}

	//gated logic
	if (!clicked){clicked = true;} else {clicked = false;}
	utils.toggleFunction(clicked, stepOne, stepTwo)

});

});